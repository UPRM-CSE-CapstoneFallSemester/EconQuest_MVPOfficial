{% extends 'base.html' %}
{% block content %}
<style>
  .auth-bg{
    position: relative; overflow: hidden;
    min-height: calc(100vh - 56px);
    background: radial-gradient(60% 80% at 50% 0%, #0b775e 0%, #066a55 40%, #055244 70%, #062a22 100%);
  }
  .auth-card{
    background: rgba(255,255,255,.9);
    backdrop-filter: blur(6px);
    border-radius: 18px;
    box-shadow: 0 25px 60px rgba(0,0,0,.25);
  }
</style>

<div class="auth-bg grid place-items-center px-4 py-10">
  <div class="relative w-full max-w-lg auth-card p-6 sm:p-8">
    <div class="absolute -top-6 left-6 w-14 h-14 rounded-2xl bg-emerald-500 text-white grid place-items-center font-extrabold shadow-lg">EQ</div>

    <h1 class="text-2xl font-extrabold text-slate-800 text-center">EconQuest</h1>
    <p class="text-center text-slate-600 mt-1">Sign in to continue your quest</p>

    <form method="post" action="{{ url_for('auth.login') }}" class="mt-6 space-y-4">
      {{ form.hidden_tag() }} <!-- CSRF -->

      <!-- 👇 Bloque de errores del form y mensajes flash -->
      {% if form.errors %}
        {% for field, errors in form.errors.items() %}
          {% for e in errors %}
            <div class="p-2 rounded bg-red-100 border border-red-300 text-red-800 text-sm">{{ e }}</div>
          {% endfor %}
        {% endfor %}
      {% endif %}

      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for cat, msg in messages %}
            <div class="p-2 rounded bg-red-100 border border-red-300 text-red-800 text-sm">{{ msg }}</div>
          {% endfor %}
        {% endif %}
      {% endwith %}
      <!-- ☝️ Hasta aquí el bloque insertado -->

      <label class="block text-sm text-slate-700">Email
        <input name="email" type="email"
               value="{{ request.form.get('email','') }}"
               class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-emerald-500"
               placeholder="you@example.com" required>
      </label>
      {% if form.email is defined %}
        {% for e in form.email.errors %}
          <p class="text-sm text-red-700">{{ e }}</p>
        {% endfor %}
      {% endif %}

      <label class="block text-sm text-slate-700">Password
        <input name="password" type="password"
               class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-emerald-500"
               placeholder="••••••••" required>
      </label>
      {% if form.password is defined %}
        {% for e in form.password.errors %}
          <p class="text-sm text-red-700">{{ e }}</p>
        {% endfor %}
      {% endif %}

      <div class="flex items-center justify-between text-sm">
        <label class="inline-flex items-center gap-2">
          <!-- ajusta el name a tu WTForm: remember o remember_me -->
          <input type="checkbox" name="remember"> <span class="text-slate-700">Remember me</span>
        </label>
        <a class="text-emerald-700 hover:underline" href="{{ url_for('auth.register') }}">Create account</a>
      </div>

      <button class="w-full rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white py-2.5 font-medium">
        Sign in
      </button>
    </form>
  </div>
</div>
{% endblock %}

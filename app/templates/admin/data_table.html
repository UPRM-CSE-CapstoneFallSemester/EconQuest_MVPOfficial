{% extends 'admin/layout.html' %} {% block admin_content %}
<div class="flex items-center justify-between mb-4">
  <h1 class="text-xl font-semibold">Data: {{ model|capitalize }}</h1>
  <a
    class="px-3 py-2 rounded bg-slate-200 dark:bg-slate-700 dark:text-slate-100"
    href="{{ url_for('admin.data_home') }}"
    >← Volver</a
  >
</div>

<div
  class="bg-white dark:bg-slate-800 dark:text-slate-100 p-5 rounded-2xl shadow overflow-x-auto"
>
  <table class="w-full text-sm">
    <thead class="text-slate-600 dark:text-slate-300">
      <tr class="text-left">
        {% for c in columns %}
        <th class="py-2 pr-3">{{ c }}</th>
        {% endfor %}
        <th class="py-2">Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for record in records %}
      <tr class="border-t border-slate-200 dark:border-slate-700 align-top">
        {% for c in columns %}
        <td class="py-2 pr-3">{{ record[c] }}</td>
        {% endfor %}
        <td class="py-2">
          <form method="post" class="inline">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
            <input type="hidden" name="action" value="delete" />
            <input type="hidden" name="id" value="{{ record['id'] }}" />
            <button
              class="px-2 py-1 rounded bg-red-600 text-white"
              onclick="return confirm('Eliminar #{{ record['id'] }}?')"
            >
              Eliminar
            </button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="mt-4 flex items-center gap-2">
    {% if page.has_prev %}
    <a
      class="px-3 py-1 rounded border dark:border-slate-700"
      href="{{ url_for('admin.data_table', model=model, page=page.prev_num) }}"
      >← Prev</a
    >
    {% endif %}
    <div class="text-sm text-slate-500 dark:text-slate-400">
      Página {{ page.page }} de {{ page.pages or 1 }}
    </div>
    {% if page.has_next %}
    <a
      class="px-3 py-1 rounded border dark:border-slate-700"
      href="{{ url_for('admin.data_table', model=model, page=page.next_num) }}"
      >Next →</a
    >
    {% endif %}
  </div>

  <details class="mt-6">
    <summary
      class="cursor-pointer text-emerald-700 dark:text-emerald-400 font-semibold"
    >
      Añadir / Editar
    </summary>
    <form method="post" class="mt-3 grid md:grid-cols-2 gap-3">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
      <input type="hidden" name="action" value="save" />
      <label class="text-sm"
        >ID (para editar):
        <input
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="id"
          placeholder="deja vacío para crear"
        />
      </label>

      {% if model == 'users' %}
      <label class="text-sm"
        >name
        <input
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="name"
      /></label>
      <label class="text-sm"
        >email
        <input
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="email"
      /></label>
      <label class="text-sm"
        >role
        <select
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="role"
        >
          <option>student</option>
          <option>teacher</option>
          <option>admin</option>
        </select>
      </label>
      <label class="text-sm"
        >locale
        <input
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="locale"
          value="es"
      /></label>

      {% elif model == 'modules' %}
      <label class="text-sm"
        >title
        <input
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="title"
      /></label>
      <label class="text-sm"
        >summary
        <input
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="summary"
      /></label>
      <label class="text-sm"
        >is_published <input type="checkbox" name="is_published"
      /></label>
      <label class="text-sm"
        >level
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="level"
      /></label>
      <label class="text-sm"
        >xp_reward
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="xp_reward"
      /></label>

      {% elif model == 'activities' %}
      <label class="text-sm"
        >title
        <input
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="title"
      /></label>
      <label class="text-sm"
        >type
        <input
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="type"
      /></label>
      <label class="text-sm"
        >max_points
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="max_points"
      /></label>
      <label class="text-sm"
        >module_id
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="module_id"
      /></label>
      <label class="text-sm"
        >position
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="position"
      /></label>
      <label class="text-sm"
        >is_published <input type="checkbox" name="is_published"
      /></label>
      <label class="text-sm"
        >attempt_limit
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="attempt_limit"
      /></label>
      <label class="text-sm"
        >default_xp
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="default_xp"
      /></label>
      <label class="text-sm md:col-span-2"
        >content_json
        <textarea
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="content_json"
          rows="4"
        ></textarea>
      </label>

      {% elif model == 'attempts' %}
      <label class="text-sm"
        >score
        <input
          type="number"
          step="1"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="score"
      /></label>

      {% elif model == 'groups' %}
      <label class="text-sm"
        >name
        <input
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="name"
      /></label>
      <label class="text-sm"
        >teacher_id
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="teacher_id"
      /></label>
      <label class="text-sm"
        >grade_level
        <input
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="grade_level"
      /></label>
      <label class="text-sm"
        >section
        <input
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="section"
      /></label>

      {% elif model == 'group_members' %}
      <label class="text-sm"
        >group_id
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="group_id"
      /></label>
      <label class="text-sm"
        >user_id
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="user_id"
      /></label>

      {% elif model == 'module_assignments' %}
      <label class="text-sm"
        >module_id
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="module_id"
      /></label>
      <label class="text-sm"
        >target_type
        <select
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="target_type"
        >
          <option>group</option>
          <option>student</option>
        </select>
      </label>
      <label class="text-sm"
        >target_id
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="target_id"
      /></label>

      {% elif model == 'user_profiles' %}
      <label class="text-sm"
        >credit_score
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="credit_score"
      /></label>
      <label class="text-sm"
        >cash_balance
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="cash_balance"
      /></label>
      <label class="text-sm"
        >salary_monthly
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="salary_monthly"
      /></label>
      <label class="text-sm"
        >has_car <input type="checkbox" name="has_car"
      /></label>
      <label class="text-sm"
        >car_payment_monthly
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="car_payment_monthly"
      /></label>
      <label class="text-sm"
        >level
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="level"
      /></label>
      <label class="text-sm"
        >xp
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="xp"
      /></label>
      <label class="text-sm"
        >energy
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="energy"
      /></label>

      {% elif model == 'game_settings' %}
      <label class="text-sm"
        >xp_base
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="xp_base"
      /></label>
      <label class="text-sm"
        >xp_growth
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="xp_growth"
      /></label>
      <label class="text-sm"
        >max_attempts_default
        <input
          type="number"
          class="border rounded px-2 py-1 w-full dark:bg-slate-900 dark:border-slate-700"
          name="max_attempts_default"
      /></label>

      {% elif model == 'auth_sessions' %}
      <label class="text-sm"
        >active <input type="checkbox" name="active"
      /></label>
      {% endif %}

      <div class="md:col-span-2">
        <button class="px-3 py-2 rounded bg-emerald-600 text-white">
          Guardar
        </button>
      </div>
    </form>
  </details>
</div>
{% endblock %}

 {% extends 'student/layout.html' %}
{% block student_content %}
<style>
  .stu-dashboard{ color:#e6f7f1; }
  .stu-title{ font-weight:700; letter-spacing:.2px; }
  .mod-grid{ display:grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap:16px; }
  .module-card{ position:relative; border-radius:16px; padding:16px 18px; background: rgba(9,45,38,.55); border:1px solid rgba(16,185,129,.28); box-shadow: inset 0 0 0 1px rgba(16,185,129,.12), 0 10px 26px rgba(0,0,0,.35); transition: transform .18s ease, filter .18s ease, box-shadow .18s ease; }
  .module-card:hover{ transform: translateY(-2px); filter: brightness(1.05); box-shadow: inset 0 0 0 1px rgba(16,185,129,.18), 0 16px 36px rgba(0,0,0,.45); }
  .module-title{ font-weight:700; color:#d0fff1; }
  .module-badge{ display:inline-block; margin-top:6px; font-size:12px; color:#7ef2c5; background: rgba(16,185,129,.12); border:1px solid rgba(16,185,129,.25); padding:.2rem .5rem; border-radius:9999px; }
  .module-badge.is-draft{ color:#e9b86a; background: rgba(234,179,8,.08); border-color:rgba(234,179,8,.25); }

  .act-grid{ display:grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap:18px; }
  @media (max-width: 1024px){ .act-grid{ grid-template-columns: 1fr; } }
  .activity-card{ position:relative; border-radius:18px; padding:16px; background: linear-gradient(180deg, rgba(11,47,40,.9), rgba(7,28,26,.9)); border:1px solid rgba(16,185,129,.22); box-shadow: 0 12px 32px rgba(0,0,0,.38), inset 0 0 40px rgba(16,185,129,.05); }
  .activity-meta{ font-size:12px; color:#a7c6be; opacity:.9; margin-bottom:10px; }
  .btn-try{ display:inline-block; margin-top:12px; background:#10b981; color:#06281f; font-weight:700; padding:.55rem 1rem; border-radius:12px; box-shadow: 0 8px 18px rgba(16,185,129,.25); transition: transform .15s ease, box-shadow .15s ease, filter .15s ease; text-decoration:none; }
  .btn-try:hover{ transform: translateY(-1px); filter:brightness(1.05); box-shadow:0 10px 22px rgba(16,185,129,.32); }
</style>

<div class="stu-dashboard space-y-8">
  <!-- ===== MÓDULOS ===== -->
  <section class="space-y-3">
    <h2 class="stu-title text-xl">Módulos disponibles</h2>
    <div class="mod-grid">
      {% if modules %}
        {% for m in modules %}
          <a href="{{ url_for('student_ui.module_detail', module_id=m.id, tab='activities') }}"
             class="module-card block no-underline"
             aria-label="Abrir módulo {{ m.title }}">
            <div class="module-title">{{ m.title }}</div>
            {% if m.summary %}<p class="mt-1 text-sm text-emerald-200/80 line-clamp-2">{{ m.summary }}</p>{% endif %}
            <div class="mt-2 flex items-center gap-2 text-xs">
              <span class="module-badge {{ '' if m.is_published else 'is-draft' }}">{{ 'Publicado' if m.is_published else 'Borrador' }}</span>
              {% if m.level %}<span class="module-badge">Nivel {{ m.level }}</span>{% endif %}
              {% if m.xp_reward %}<span class="module-badge">+{{ m.xp_reward }} XP</span>{% endif %}
              <span class="ml-auto text-emerald-300/90">Abrir →</span>
            </div>
          </a>
        {% endfor %}
      {% else %}
        <div class="text-emerald-200/70">No tienes módulos asignados aún. Cuando tu profesor publique o asigne módulos, aparecerán aquí.</div>
      {% endif %}
    </div>
  </section>

  <!-- ===== ACTIVIDADES (de tus módulos) ===== -->
  <section class="space-y-3">
    <h2 class="stu-title text-xl">Actividades</h2>
    {% if activities %}
      <div class="act-grid">
        {% for a in activities %}
          <div class="activity-card">
            <div class="activity-meta">
              {{ a.module.title if a.module else 'Módulo' }} ·
              {{ a.type or 'text' }} · Max {{ a.max_points or 0 }} pts
            </div>
            <div class="text-emerald-100 font-semibold">{{ a.title }}</div>
            <a class="btn-try" href="{{ url_for('student_ui.play_activity', activity_id=a.id) }}">Play</a>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="text-emerald-200/70">Aún no hay actividades publicadas para tus módulos.</div>
    {% endif %}
  </section>
</div>
{% endblock %}
